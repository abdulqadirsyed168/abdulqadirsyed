#----------STORE RAW DATA IN HDFS LOCATION ?
hdfs://tmp/hadoop_hive_dir/sales_order_data.csv.txt

create table sales_order_data_csv
(
ORDERNUMBER int,
QUANTITYORDERED int,
PRICEEACH float,
ORDERLINENUMBER int,
SALES float,
STATUS string,
QTR_ID int,
MONTH_ID int,
YEAR_ID int,
PRODUCTLINE string,
MSRP int,
PRODUCTCODE string,
PHONE string,
CITY string,
STATE string,
POSTALCODE string,
COUNTRY string,
TERRITORY string,
CONTACTLASTNAME string,
CONTACTFIRSTNAME string,
DEALSIZE string
)
row format delimited
fields terminated by ','
tblproperties("skip.header.line.count"="1");

load data inpath '/tmp/hadoop_hive_dir/' into table sales_order_data_csv

create table sales_order_data_orc
(
ORDERNUMBER int,
QUANTITYORDERED int,
PRICEEACH float,
ORDERLINENUMBER int,
SALES float,
STATUS string,
QTR_ID int,
MONTH_ID int,
YEAR_ID int,
PRODUCTLINE string,
MSRP int,
PRODUCTCODE string,
PHONE string,
CITY string,
STATE string,
POSTALCODE string,
COUNTRY string,
TERRITORY string,
CONTACTLASTNAME string,
CONTACTFIRSTNAME string,
DEALSIZE string
)
stored as orc;

from sales_order_data_csv insert overwrite table sales_order_data_orc select *;


#----CALCULATE TOTAL SALES PER YEAR ?
SELECT PRODUCTLINE, SUM (QUANTITYORDERED) AS TOTAL_ORDER FROM sales_order_data_orc group by PRODUCTLINE Order by TOTAL_ORDER DESC

#----------FIND A PRODUCT FOR WHICH MAXIMUM ORDERS WERE PLACED ?
SELECT YEAR_ID , SUM (SALES) AS TOTAL_SALES FROM sales_order_data_orc group by YEAR_ID Order by YEAR_ID

#-----------CALCULATE THE TOTAL SALES FOR EACH QUARTER ?

#-----------YEAR = 2003
SELECT MONTH_ID, SUM (SALES) AS EACH_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2003 AND MONTH_ID BETWEEN 1 AND 3 GROUP BY MONTH_ID 

SELECT MONTH_ID, SUM (SALES) AS EACH_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2003 AND MONTH_ID BETWEEN 4 AND 6 GROUP BY MONTH_ID

SELECT MONTH_ID, SUM (SALES) AS EACH_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2003 AND MONTH_ID BETWEEN 7 AND 9 GROUP BY MONTH_ID

SELECT MONTH_ID, SUM (SALES) AS EACH_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2003 AND MONTH_ID BETWEEN 10 AND 12 GROUP BY MONTH_ID

#----------YEAR = 2004
SELECT MONTH_ID, SUM (SALES) AS EACH_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2004 AND MONTH_ID BETWEEN 1 AND 3 GROUP BY MONTH_ID 

SELECT MONTH_ID, SUM (SALES) AS EACH_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2004 AND MONTH_ID BETWEEN 4 AND 6 GROUP BY MONTH_ID

SELECT MONTH_ID, SUM (SALES) AS EACH_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2004 AND MONTH_ID BETWEEN 7 AND 9 GROUP BY MONTH_ID

SELECT MONTH_ID, SUM (SALES) AS EACH_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2004 AND MONTH_ID BETWEEN 10 AND 12 GROUP BY MONTH_ID

#----------YEAR = 2005
SELECT MONTH_ID, SUM (SALES) AS EACH_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2005 AND MONTH_ID BETWEEN 1 AND 3 GROUP BY MONTH_ID 

SELECT MONTH_ID, SUM (SALES) AS EACH_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2005 AND MONTH_ID BETWEEN 4 AND 6 GROUP BY MONTH_ID

SELECT MONTH_ID, SUM (SALES) AS EACH_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2005 AND MONTH_ID BETWEEN 7 AND 9 GROUP BY MONTH_ID

SELECT MONTH_ID, SUM (SALES) AS EACH_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2005 AND MONTH_ID BETWEEN 10 AND 12 GROUP BY MONTH_ID

#----------IN WHICH QUARTER SALES WAS MINIMUM ?

#----------YEAR = 2003
SELECT MONTH_ID, MIN (SALES) AS MIN_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2003 AND MONTH_ID BETWEEN 1 AND 3 GROUP BY MONTH_ID 
ORDER BY MIN_QUATER_SALES ASC

SELECT MONTH_ID, MIN (SALES) AS MIN_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2003 AND MONTH_ID BETWEEN 4 AND 6 GROUP BY MONTH_ID 
ORDER BY MIN_QUATER_SALES ASC

SELECT MONTH_ID, MIN (SALES) AS MIN_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2003 AND MONTH_ID BETWEEN 7 AND 9 GROUP BY MONTH_ID 
ORDER BY MIN_QUATER_SALES ASC

SELECT MONTH_ID, MIN (SALES) AS MIN_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2003 AND MONTH_ID BETWEEN 10 AND 12 GROUP BY MONTH_ID 
ORDER BY MIN_QUATER_SALES ASC

#-----------YEAR = 2004
SELECT MONTH_ID, MIN (SALES) AS MIN_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2004 AND MONTH_ID BETWEEN 1 AND 3 GROUP BY MONTH_ID 
ORDER BY MIN_QUATER_SALES ASC

SELECT MONTH_ID, MIN (SALES) AS MIN_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2004 AND MONTH_ID BETWEEN 4 AND 6 GROUP BY MONTH_ID 
ORDER BY MIN_QUATER_SALES ASC

SELECT MONTH_ID, MIN (SALES) AS MIN_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2004 AND MONTH_ID BETWEEN 7 AND 9 GROUP BY MONTH_ID 
ORDER BY MIN_QUATER_SALES ASC

SELECT MONTH_ID, MIN (SALES) AS MIN_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2004 AND MONTH_ID BETWEEN 10 AND 12 GROUP BY MONTH_ID 
ORDER BY MIN_QUATER_SALES ASC

#------------YEAR = 2005
SELECT MONTH_ID, MIN (SALES) AS MIN_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2005 AND MONTH_ID BETWEEN 1 AND 3 GROUP BY MONTH_ID 
ORDER BY MIN_QUATER_SALES ASC

SELECT MONTH_ID, MIN (SALES) AS MIN_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2005 AND MONTH_ID BETWEEN 4 AND 6 GROUP BY MONTH_ID 
ORDER BY MIN_QUATER_SALES ASC

SELECT MONTH_ID, MIN (SALES) AS MIN_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2005 AND MONTH_ID BETWEEN 7 AND 9 GROUP BY MONTH_ID 
ORDER BY MIN_QUATER_SALES ASC

SELECT MONTH_ID, MIN (SALES) AS MIN_QUATER_SALES FROM sales_order_data_orc Where YEAR_ID = 2005 AND MONTH_ID BETWEEN 10 AND 12 GROUP BY MONTH_ID 
ORDER BY MIN_QUATER_SALES ASC


#----------IN WHICH COUNTRY SALES WAS MAXIMUM AND IN WHICH COUNTRY SALES WAS MINIMUM ?

SELECT COUNTRY, MAX(SALES) AS MAX_SALES FROM sales_order_data_orc group by COUNTRY ORDER BY MAX_SALES DESC

SELECT COUNTRY, MIN(SALES) AS MIN_SALES FROM sales_order_data_orc group by COUNTRY ORDER BY MIN_SALES ASC



#-----------CALCULATE QUARTELY SALES FOR EACH CITY ?

#--------YEAR = 2003
SELECT CITY, SUM (SALES) AS QUATERLY_SALES FROM sales_order_data_orc Where YEAR_ID = 2003 AND MONTH_ID BETWEEN 1 AND 3 GROUP BY CITY ORDER BY QUATERLY_SALES DESC

SELECT CITY, SUM (SALES) AS QUATERLY_SALES FROM sales_order_data_orc Where YEAR_ID = 2003 AND MONTH_ID BETWEEN 4 AND 6 GROUP BY CITY ORDER BY QUATERLY_SALES DESC

SELECT CITY, SUM (SALES) AS QUATERLY_SALES FROM sales_order_data_orc Where YEAR_ID = 2003 AND MONTH_ID BETWEEN 7 AND 9 GROUP BY CITY ORDER BY QUATERLY_SALES DESC

SELECT CITY, SUM (SALES) AS QUATERLY_SALES FROM sales_order_data_orc Where YEAR_ID = 2003 AND MONTH_ID BETWEEN 10 AND 12 GROUP BY CITY ORDER BY QUATERLY_SALES DESC


#--------YEAR = 2004
SELECT CITY, SUM (SALES) AS QUATERLY_SALES FROM sales_order_data_orc Where YEAR_ID = 2004 AND MONTH_ID BETWEEN 1 AND 3 GROUP BY CITY ORDER BY QUATERLY_SALES DESC

SELECT CITY, SUM (SALES) AS QUATERLY_SALES FROM sales_order_data_orc Where YEAR_ID = 2004 AND MONTH_ID BETWEEN 4 AND 6 GROUP BY CITY ORDER BY QUATERLY_SALES DESC

SELECT CITY, SUM (SALES) AS QUATERLY_SALES FROM sales_order_data_orc Where YEAR_ID = 2004 AND MONTH_ID BETWEEN 7 AND 9 GROUP BY CITY ORDER BY QUATERLY_SALES DESC

SELECT CITY, SUM (SALES) AS QUATERLY_SALES FROM sales_order_data_orc Where YEAR_ID = 2004 AND MONTH_ID BETWEEN 10 AND 12 GROUP BY CITY ORDER BY QUATERLY_SALES DESC


#--------YEAR = 2005
SELECT CITY, SUM (SALES) AS QUATERLY_SALES FROM sales_order_data_orc Where YEAR_ID = 2005 AND MONTH_ID BETWEEN 1 AND 3 GROUP BY CITY ORDER BY QUATERLY_SALES DESC

SELECT CITY, SUM (SALES) AS QUATERLY_SALES FROM sales_order_data_orc Where YEAR_ID = 2005 AND MONTH_ID BETWEEN 4 AND 6 GROUP BY CITY ORDER BY QUATERLY_SALES DESC

SELECT CITY, SUM (SALES) AS QUATERLY_SALES FROM sales_order_data_orc Where YEAR_ID = 2005 AND MONTH_ID BETWEEN 7 AND 9 GROUP BY CITY ORDER BY QUATERLY_SALES DESC

SELECT CITY, SUM (SALES) AS QUATERLY_SALES FROM sales_order_data_orc Where YEAR_ID = 2005 AND MONTH_ID BETWEEN 10 AND 12 GROUP BY CITY ORDER BY QUATERLY_SALES DESC


#-----------FIND A MONTH FOR EACH YEAR IN WHICH MAXIMUM NUMBER OF QUANTITIES WERE SOLD ?

SELECT YEAR_ID, SUM(QUANTITYORDERED) AS QUANTITY_SOLD FROM sales_order_data_orc GROUP BY YEAR_ID ORDER BY QUANTITY_SOLD DESC
