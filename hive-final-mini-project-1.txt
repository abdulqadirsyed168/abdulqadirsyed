 create table AgentLogingReport
    > (
    > SL_No float,
    > Agent varchar(255),
    > Date date,
    > Login_Time timestamp,
    > Logout_Time timestamp,
    > Duration timestamp
    > )
    > row format serde 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
    > tblproperties ("skip.header.line.count" = "1");
    
    > load data inpath '/tmp/hadoop_dir/AgentLogingReport.csv' into table AgentLogingReport;
    
    
    > create table AgentPerformance
    > (
    > SL_No float,
    > Date date,
    > Agent_Name varchar(255),
    > Total_Chats float,
    > Average_Response_Time timestamp,
    > Average_Resolution_Time timestamp,
    > Average_Rating float,
    > Total_Feedback float
    > )
    > row format serde 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
    > tblproperties ("skip.header.line.count" = "1");
    
    load data inpath '/tmp/hadoop_dir/AgentPerformance.csv' into table AgentPerformance;
    
    #  List of all agents' names.
    SELECT agent FROM agentlogingreport
    > UNION
    > SELECT agent_name FROM agentperformance;
    
    
    # Find out agent average rating.
    > SELECT AVG(AVERAGE_RATING) AS Average_Rating,AGENT_NAME
    > FROM Agentperformance
    > GROUP BY AGENT_NAME
    > ORDER BY Average_Rating DESC;
    
    # Total working days for each agents
    > SELECT COUNT(Login_Time) as Total_Working_days, Agent
    > FROM Agentlogingreport
    > GROUP BY Agent
    > ORDER BY Total_Working_days;
    
    # Total query that each agent have taken
    > SELECT SUM(TOTAL_CHATS) AS TOTAL_QUERY, AGENT_NAME
    > FROM Agentperformance
    > GROUP BY AGENT_NAME
    > ORDER BY TOTAL_QUERY DESC;
    
    # Total Feedback that each agent have received
    > SELECT SUM(TOTAL_FEEDBACK) AS TOTAL_FEEDBACK, AGENT_NAME
    > FROM Agentperformance
    > GROUP BY AGENT_NAME
    > ORDER BY TOTAL_FEEDBACK DESC;
    
    # Agent name who have average rating between 3.5 to 4
    > SELECT AVERAGE_RATING,AGENT_NAME FROM Agentperformance
    > WHERE AVERAGE_RATING BETWEEN 3.5 AND 4
    > ORDER BY AVERAGE_RATING;
    
    # Agent name who have rating less than 3.5
    > SELECT AVERAGE_RATING,AGENT_NAME FROM Agentperformance
    > WHERE AVERAGE_RATING < 3.5
    > ORDER BY AVERAGE_RATING DESC;
    
    # Agent name who have rating more than 4.5
    > SELECT AVERAGE_RATING,AGENT_NAME FROM Agentperformance
    > WHERE AVERAGE_RATING > 4.5
    > ORDER BY AVERAGE_RATING;
    
    # How many feedback agents have received more than 4.5 average
    SELECT TOTAL_FEEDBACK,AGENT_NAME  FROM Agentperformance
    > WHERE TOTAL_FEEDBACK > 4.5
    > ORDER BY TOTAL_FEEDBACK;
    
    # average weekly response time for each agent
    
    
    
    
    
